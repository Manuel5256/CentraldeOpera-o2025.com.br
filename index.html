&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;pt-BR&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot; /&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;
  &lt;title&gt;Central de Opera&ccedil;&atilde;o - Grupo Claudino&lt;/title&gt;

  &lt;!-- Choices.js CSS para select com busca --&gt;
  &lt;link
    rel=&quot;stylesheet&quot;
    href=&quot;https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css&quot;
  /&gt;

  &lt;style&gt;
    /* Reset e base */
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f0f4f8;
      margin: 0;
      padding: 0 15px 50px;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      width: 100%;
      background-color: #0a3d91;
      padding: 20px 0;
      border-radius: 0 0 15px 15px;
      box-shadow: 0 3px 8px rgb(10 61 145 / 0.4);
      text-align: center;
      color: white;
      font-weight: 700;
      font-size: 1.8rem;
      user-select: none;
      letter-spacing: 1.2px;
    }
    main {
      background-color: white;
      max-width: 750px;
      width: 100%;
      margin-top: 30px;
      padding: 25px 35px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgb(10 61 145 / 0.15);
    }
    label {
      display: block;
      font-weight: 600;
      margin-top: 18px;
      font-size: 1.2rem;
      color: #0a3d91;
    }
    input[type=&quot;text&quot;],
    select,
    .choices__inner {
      width: 100%;
      padding: 12px 15px;
      font-size: 1.1rem;
      margin-top: 6px;
      border-radius: 6px;
      border: 1.8px solid #0a3d91;
    }
    input[readonly] { background-color: #e9f0fc; color: #555; }
    .radio-group { margin-top: 10px; display: flex; gap: 20px; align-items: center; }
    .buttons { margin-top: 30px; display: flex; gap: 15px; }
    button {
      flex: 1; min-width: 150px; padding: 14px 20px;
      font-size: 1.15rem; font-weight: 700;
      border: none; border-radius: 8px; cursor: pointer;
      color: white;
    }
    .btn-primary { background-color: #0a3d91; }
    .btn-whatsapp { background-color: #25d366; }
    .btn-export { background-color: #1774e1; }
    #ocorrenciasGeradas { margin-top: 40px; max-height: 350px; overflow-y: auto; }
    .ocorrencia { background: #e6f0fc; border-radius: 8px; padding: 16px 20px; margin-bottom: 20px; }
    #tabelaOcorrencias { margin-top: 40px; width: 100%; border-collapse: collapse; display: none; }
    #tabelaOcorrencias th, #tabelaOcorrencias td { border: 1px solid #0a3d91; padding: 10px; }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    CENTRAL DE OPERA&Ccedil;&Atilde;O - GRUPO CLAUDINO
  &lt;/header&gt;

  &lt;main&gt;
    &lt;form id=&quot;ocorrenciaForm&quot; autocomplete=&quot;off&quot;&gt;
      &lt;label for=&quot;remetente&quot;&gt;Remetente:&lt;/label&gt;
      &lt;input type=&quot;text&quot; id=&quot;remetente&quot; value=&quot;Central de Opera&ccedil;&otilde;es&quot; readonly /&gt;

      &lt;label for=&quot;dataHora&quot;&gt;Data/Hora:&lt;/label&gt;
      &lt;input type=&quot;text&quot; id=&quot;dataHora&quot; readonly /&gt;

      &lt;!-- Container para Local Monitorado --&gt;
      &lt;div id=&quot;localMonitoradoContainer&quot;&gt;
        &lt;span&gt;Local Monitorado: &lt;span id=&quot;numeroLojas&quot;&gt;0&lt;/span&gt;&lt;/span&gt;
        &lt;select id=&quot;localMonitorado&quot; name=&quot;localMonitorado&quot;&gt;
          &lt;option value=&quot;CDM CODO MERCADO CENTRAL&quot;&gt;CDM-CODO MERCADO CENTRAL&lt;/option&gt;
          &lt;option value=&quot;TIN TIMBIRAS&quot;&gt;TIN-TIMBIRAS&lt;/option&gt;
          &lt;option value=&quot;SDE S&Atilde;O DESID&Eacute;RIO&quot;&gt;SDE-S&Atilde;O DESID&Eacute;RIO&lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;

      &lt;label for=&quot;tipoOcorrencia&quot;&gt;Tipo de Ocorr&ecirc;ncia:&lt;/label&gt;
      &lt;select id=&quot;tipoOcorrencia&quot; name=&quot;tipoOcorrencia&quot;&gt;
        &lt;option value=&quot;Alarme Disparado&quot;&gt;Alarme Disparado&lt;/option&gt;
        &lt;option value=&quot;Alarme Inativo&quot;&gt;Alarme Inativo&lt;/option&gt;
      &lt;/select&gt;

      &lt;label for=&quot;status&quot;&gt;Status:&lt;/label&gt;
      &lt;select id=&quot;status&quot; name=&quot;status&quot;&gt;
        &lt;option value=&quot;Sem altera&ccedil;&atilde;o&quot;&gt;Sem altera&ccedil;&atilde;o&lt;/option&gt;
        &lt;option value=&quot;Com altera&ccedil;&atilde;o&quot;&gt;Com altera&ccedil;&atilde;o&lt;/option&gt;
      &lt;/select&gt;

      &lt;label&gt;Tem Imagem?&lt;/label&gt;
      &lt;div class=&quot;radio-group&quot;&gt;
        &lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;temImagem&quot; value=&quot;Sim&quot; checked /&gt; Sim&lt;/label&gt;
        &lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;temImagem&quot; value=&quot;N&atilde;o&quot; /&gt; N&atilde;o&lt;/label&gt;
      &lt;/div&gt;

      &lt;div class=&quot;buttons&quot;&gt;
        &lt;button type=&quot;button&quot; class=&quot;btn-primary&quot; onclick=&quot;gerarOcorrencia()&quot;&gt;Gerar Ocorr&ecirc;ncia&lt;/button&gt;
        &lt;button type=&quot;button&quot; class=&quot;btn-whatsapp&quot; onclick=&quot;compartilharWhatsApp()&quot;&gt;Compartilhar no WhatsApp&lt;/button&gt;
        &lt;button type=&quot;button&quot; class=&quot;btn-export&quot; onclick=&quot;exportarParaExcel('tabelaOcorrencias', 'ocorrencias')&quot;&gt;Exportar Excel&lt;/button&gt;
      &lt;/div&gt;
    &lt;/form&gt;

    &lt;div id=&quot;ocorrenciasGeradas&quot;&gt;&lt;/div&gt;

    &lt;table id=&quot;tabelaOcorrencias&quot;&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;N&uacute;mero&lt;/th&gt;
          &lt;th&gt;Remetente&lt;/th&gt;
          &lt;th&gt;Data/Hora&lt;/th&gt;
          &lt;th&gt;Local&lt;/th&gt;
          &lt;th&gt;Ocorr&ecirc;ncia&lt;/th&gt;
          &lt;th&gt;Status&lt;/th&gt;
          &lt;th&gt;Imagem&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;&lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/main&gt;

  &lt;footer&gt;&amp;copy; 2025 Central de Opera&ccedil;&atilde;o&lt;/footer&gt;

  &lt;script&gt;
    function atualizarDataHora() {
      const campo = document.getElementById('dataHora');
      const agora = new Date();
      campo.value = agora.toLocaleString('pt-BR');
    }
    setInterval(atualizarDataHora, 1000); atualizarDataHora();

    let contador = 0;
    function gerarOcorrencia() {
      contador++;
      const remetente = document.getElementById('remetente').value;
      const dataHora = document.getElementById('dataHora').value;
      const local = document.getElementById('localMonitorado').value;
      const tipo = document.getElementById('tipoOcorrencia').value;
      const status = document.getElementById('status').value;
      const img = document.querySelector('input[name=&quot;temImagem&quot;]:checked').value;

      const div = document.createElement('div');
      div.className = &quot;ocorrencia&quot;;
      div.innerHTML = `
        &lt;p&gt;&lt;strong&gt;N&uacute;mero:&lt;/strong&gt; ${contador}&lt;/p&gt;
        &lt;p&gt;&lt;strong&gt;Remetente:&lt;/strong&gt; ${remetente}&lt;/p&gt;
        &lt;p&gt;&lt;strong&gt;Data/Hora:&lt;/strong&gt; ${dataHora}&lt;/p&gt;
        &lt;p&gt;&lt;strong&gt;Local:&lt;/strong&gt; ${local}&lt;/p&gt;
        &lt;p&gt;&lt;strong&gt;Ocorr&ecirc;ncia:&lt;/strong&gt; ${tipo}&lt;/p&gt;
        &lt;p&gt;&lt;strong&gt;Status:&lt;/strong&gt; ${status}&lt;/p&gt;
        &lt;p&gt;&lt;strong&gt;Imagem:&lt;/strong&gt; ${img}&lt;/p&gt;
      `;
      document.getElementById('ocorrenciasGeradas').appendChild(div);

      const tr = document.createElement('tr');
      tr.innerHTML = `&lt;td&gt;${contador}&lt;/td&gt;&lt;td&gt;${remetente}&lt;/td&gt;&lt;td&gt;${dataHora}&lt;/td&gt;&lt;td&gt;${local}&lt;/td&gt;&lt;td&gt;${tipo}&lt;/td&gt;&lt;td&gt;${status}&lt;/td&gt;&lt;td&gt;${img}&lt;/td&gt;`;
      document.querySelector('#tabelaOcorrencias tbody').appendChild(tr);
      document.getElementById('tabelaOcorrencias').style.display = &quot;table&quot;;
    }

    // ðŸ”¹ Compartilhar no WhatsApp (enviar para v&aacute;rios gerentes)
    function compartilharWhatsApp() {
      const container = document.getElementById('ocorrenciasGeradas');
      if (container.children.length === 0) {
        alert('Nenhuma ocorr&ecirc;ncia gerada para compartilhar!');
        return;
      }

      const numerosGerentes = [
        &quot;5586999998888&quot;, // Gerente 1
        &quot;5586988887777&quot;, // Gerente 2
        &quot;5586977776666&quot;  // Gerente 3
      ];

      const ultima = container.lastElementChild;
      let texto = '';
      ultima.querySelectorAll('p').forEach(p =&gt; { texto += p.textContent + '\n'; });

      const textoCodificado = encodeURIComponent(texto.trim());
      numerosGerentes.forEach(numero =&gt; {
        const url = `https://wa.me/${numero}?text=${textoCodificado}`;
        window.open(url, '_blank');
      });
    }

    function exportarParaExcel(idTabela, nomeArquivo) {
      const tabela = document.getElementById(idTabela);
      if (!tabela || tabela.style.display === 'none') {
        alert(&quot;N&atilde;o h&aacute; dados para exportar!&quot;);
        return;
      }
      const html = tabela.outerHTML;
      const link = document.createElement('a');
      link.href = 'data:application/vnd.ms-excel,' + encodeURIComponent(html);
      link.download = (nomeArquivo || 'export') + '.xls';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
